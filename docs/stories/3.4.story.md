# Story 3.4: AWS and GitHub Account Setup

## Status
Implementation Complete - Ready for QA Review

## Story
**As a** DevOps engineer,  
**I want** properly configured AWS and GitHub accounts for the project,  
**so that** we can deploy and manage the Security Design Assistant infrastructure.

## Acceptance Criteria
1. AWS account configuration completed:
   - New AWS CLI profile `design-lee` created using existing `lee-hayton` IAM user for local development
   - New AWS CLI profile `design` created using existing `7c-IAM-Admin-User` for CI/CD deployments
   - S3 deployment bucket created for SAM artifacts in eu-west-2
   - Cost tracking tags configured for the project
2. GitHub repository structure established:
   - Investigate Ric's GitHub account for optimal organization structure
   - Create 7Central organization or use existing structure
   - Create design-assistant repository with proper settings
   - Configure repository access for development workflow
3. Local development workflow configured:
   - Lee's local git configured to push to Ric's repository
   - AWS CLI profile `design-lee` working locally
   - Test deployment permissions with simple SAM app
4. Documentation created:
   - AWS account setup documented
   - GitHub repository structure documented
   - Local development workflow documented
   - Credentials and access management documented

## Tasks / Subtasks
- [x] Investigate Current AWS Setup (AC: 1)
  - [x] Check existing AWS profiles on local system
  - [x] Verify access with `argan-lee` profile to AWS account
  - [x] Document current AWS account ID and region
  - [x] Review existing resources and billing setup
- [x] Create AWS Profile Configuration (AC: 1)
  - [x] Configure local AWS CLI profile `design-lee` using existing `lee-hayton` IAM user
  - [x] Configure local AWS CLI profile `design` using existing `7c-IAM-Admin-User`
  - [x] Test profile access with `aws sts get-caller-identity --profile design-lee`
  - [x] Test profile access with `aws sts get-caller-identity --profile design`
  - [x] Document that both users already have AdministratorAccess policy
- [x] Create S3 Deployment Bucket (AC: 1)
  - [x] Create S3 bucket `security-assistant-sam-deployments` in eu-west-2
  - [x] Configure bucket with versioning enabled
  - [x] Set up lifecycle policy for old deployment artifacts (30 day retention)
  - [x] Apply project tags: `Project=SecurityDesignAssistant`, `ManagedBy=SAM`
- [x] Investigate GitHub Account Structure (AC: 2)
  - [x] Access 7-central GitHub account (new dedicated account created)
  - [x] Found fresh account with no existing structure
  - [x] Determined optimal structure: Direct repository with future organization migration
  - [x] Documented approach for multi-business structure (7Central → Security/Argan/Tier8)
- [x] Create GitHub Repository (AC: 2)
  - [x] Created repository: 7-central/security-design-assistant
  - [x] Configure repository settings:
    - [x] Set main as default branch
    - [x] Enable issues and projects
    - [x] Add repository description and topics (ai, security, design-review, aws, serverless, gemini, python)
  - [x] Added comprehensive .gitignore for Python projects
  - [x] Created develop branch for staging deployments
  - [x] Added junksamiad as collaborator with push access
- [x] Configure Local Development Workflow (AC: 3)
  - [x] Added 7-central repository as remote origin
  - [x] Configured git credentials (junksamiad account with proper email)
  - [x] Set up local repository with proper .gitignore
  - [x] Completed initial commit and push to main branch
  - [x] Documented the workflow: develop locally as junksamiad, push to 7-central repo
- [x] Test AWS Deployment Setup (AC: 3)
  - [x] Create simple test SAM application
  - [x] Run `sam build` locally
  - [x] Run `sam deploy --profile design-lee` to test permissions
  - [x] Verify resources created in AWS console
  - [x] Clean up test resources
- [x] Create Setup Documentation (AC: 4)
  - [x] Create `docs/setup/aws-setup.md` with:
    - AWS account ID and configuration
    - IAM user and policy details
    - Profile configuration steps
    - Required AWS CLI commands
  - [x] Create `docs/setup/github-setup.md` with:
    - Repository structure explanation
    - Access management approach
    - Branch strategy
    - Development workflow
  - [x] Create `docs/setup/local-development.md` with:
    - Git remote configuration
    - AWS profile setup
    - Testing deployment locally
    - Troubleshooting common issues
  - [x] Update main README.md with setup instructions

## Dev Notes

### Current Situation Context
- **AWS Account**: Existing account (445567098699) in eu-west-2 region, shared by all 7Central businesses
- **Business Structure**: 7Central (group) → Argan, Security Design, Tier8 (businesses)
- **New Profiles Needed**: 
  - `design-lee`: Using existing `lee-hayton` IAM user for local development
  - `design`: Using existing `7c-IAM-Admin-User` for CI/CD deployments
- **Project Namespace**: All resources should be prefixed with `security-assistant-` or tagged with `Project=SecurityDesignAssistant`
- **GitHub Setup**: 
  - Owner: Ric (has provided credentials)
  - Developer: Lee uses `junksamiad` account locally, pushes to Ric's repo
  - Need to investigate best organization structure on Ric's account

### AWS Resources Required [Source: architecture/infrastructure-and-deployment.md]
Based on the infrastructure requirements, the IAM policy needs permissions for:
- S3: Bucket and object operations
- Lambda: Function management
- API Gateway: REST API management
- DynamoDB: Table operations
- CloudFormation: Stack operations (for SAM)
- IAM: Role creation for Lambda execution
- CloudWatch: Logs, metrics, alarms
- SQS: Queue management
- SNS: Topic management
- X-Ray: Tracing (optional)

### S3 Deployment Bucket Requirements [Source: infrastructure/samconfig.toml]
- Bucket name: `security-assistant-sam-deployments`
- Region: `eu-west-2`
- Purpose: Store SAM deployment artifacts
- Versioning: Should be enabled for rollback capability

### GitHub Repository Requirements
Repository needs:
- Main branch (production deployments)
- Develop branch (staging deployments)
- Branch protection rules
- GitHub Actions secrets for AWS credentials:
  - `AWS_ACCESS_KEY_ID`
  - `AWS_SECRET_ACCESS_KEY`
  - `AWS_REGION` (eu-west-2)

### Environment Naming Convention [Source: architecture/infrastructure-and-deployment.md]
- Development: Local only (no AWS)
- Staging: `security-assistant-staging-*`
- Production: `security-assistant-prod-*`

### Testing
**Testing Requirements**:
- Verify AWS CLI profile works: `aws sts get-caller-identity --profile design-lee`
- Test S3 access: `aws s3 ls --profile design-lee`
- Test SAM deployment permissions with minimal template
- Verify GitHub push access from local development environment

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-10 | 1.0 | Initial story draft created | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
Claude Opus 4.1 (claude-opus-4-1-20250805)

### Debug Log References
N/A - No debug logs generated

### Completion Notes List
- AWS profiles successfully configured (design-lee and design)
- S3 deployment bucket created with proper configuration
- Test deployment successful and cleaned up
- Documentation created for all setup processes
- Region updated from us-east-1 to eu-west-2 based on existing infrastructure
- GitHub account 7-central created with dedicated credentials
- Repository security-design-assistant created with proper structure
- Local development workflow configured and tested
- Initial project code committed and pushed to GitHub
- junksamiad added as collaborator with push access

### File List
- Created: docs/setup/aws-setup.md
- Created: docs/setup/local-development.md  
- Created: docs/setup/github-setup.md
- Modified: docs/stories/3.4.story.md
- Modified: README.md
- Modified: .gitignore (added project-specific exclusions)
- Created: Initial git repository with 143 files committed
- Created: GitHub repository 7-central/security-design-assistant
- Created: develop branch in GitHub repository

## QA Results
_To be filled by QA Agent_