# Story 3.4: AWS and GitHub Account Setup

## Status
Done

## Story
**As a** DevOps engineer,  
**I want** properly configured AWS and GitHub accounts for the project,  
**so that** we can deploy and manage the Security Design Assistant infrastructure.

## Acceptance Criteria
1. AWS account configuration completed:
   - New AWS CLI profile `design-lee` created using existing `lee-hayton` IAM user for local development
   - New AWS CLI profile `design` created using existing `7c-IAM-Admin-User` for CI/CD deployments
   - S3 deployment bucket created for SAM artifacts in eu-west-2
   - Cost tracking tags configured for the project
2. GitHub repository structure established:
   - Investigate Ric's GitHub account for optimal organization structure
   - Create 7Central organization or use existing structure
   - Create design-assistant repository with proper settings
   - Configure repository access for development workflow
3. Local development workflow configured:
   - Lee's local git configured to push to Ric's repository
   - AWS CLI profile `design-lee` working locally
   - Test deployment permissions with simple SAM app
4. Documentation created:
   - AWS account setup documented
   - GitHub repository structure documented
   - Local development workflow documented
   - Credentials and access management documented

## Tasks / Subtasks
- [x] Investigate Current AWS Setup (AC: 1)
  - [x] Check existing AWS profiles on local system
  - [x] Verify access with `argan-lee` profile to AWS account
  - [x] Document current AWS account ID and region
  - [x] Review existing resources and billing setup
- [x] Create AWS Profile Configuration (AC: 1)
  - [x] Configure local AWS CLI profile `design-lee` using existing `lee-hayton` IAM user
  - [x] Configure local AWS CLI profile `design` using existing `7c-IAM-Admin-User`
  - [x] Test profile access with `aws sts get-caller-identity --profile design-lee`
  - [x] Test profile access with `aws sts get-caller-identity --profile design`
  - [x] Document that both users already have AdministratorAccess policy
- [x] Create S3 Deployment Bucket (AC: 1)
  - [x] Create S3 bucket `security-assistant-sam-deployments` in eu-west-2
  - [x] Configure bucket with versioning enabled
  - [x] Set up lifecycle policy for old deployment artifacts (30 day retention)
  - [x] Apply project tags: `Project=SecurityDesignAssistant`, `ManagedBy=SAM`
- [x] Investigate GitHub Account Structure (AC: 2)
  - [x] Access 7-central GitHub account (new dedicated account created)
  - [x] Found fresh account with no existing structure
  - [x] Determined optimal structure: Direct repository with future organization migration
  - [x] Documented approach for multi-business structure (7Central → Security/Argan/Tier8)
- [x] Create GitHub Repository (AC: 2)
  - [x] Created repository: 7-central/security-design-assistant
  - [x] Configure repository settings:
    - [x] Set main as default branch
    - [x] Enable issues and projects
    - [x] Add repository description and topics (ai, security, design-review, aws, serverless, gemini, python)
  - [x] Added comprehensive .gitignore for Python projects
  - [x] Created develop branch for staging deployments
  - [x] Added junksamiad as collaborator with push access
- [x] Configure Local Development Workflow (AC: 3)
  - [x] Added 7-central repository as remote origin
  - [x] Configured git credentials (junksamiad account with proper email)
  - [x] Set up local repository with proper .gitignore
  - [x] Completed initial commit and push to main branch
  - [x] Documented the workflow: develop locally as junksamiad, push to 7-central repo
- [x] Test AWS Deployment Setup (AC: 3)
  - [x] Create simple test SAM application
  - [x] Run `sam build` locally
  - [x] Run `sam deploy --profile design-lee` to test permissions
  - [x] Verify resources created in AWS console
  - [x] Clean up test resources
- [x] Create Setup Documentation (AC: 4)
  - [x] Create `docs/setup/aws-setup.md` with:
    - AWS account ID and configuration
    - IAM user and policy details
    - Profile configuration steps
    - Required AWS CLI commands
  - [x] Create `docs/setup/github-setup.md` with:
    - Repository structure explanation
    - Access management approach
    - Branch strategy
    - Development workflow
  - [x] Create `docs/setup/local-development.md` with:
    - Git remote configuration
    - AWS profile setup
    - Testing deployment locally
    - Troubleshooting common issues
  - [x] Update main README.md with setup instructions

## Dev Notes

### Current Situation Context
- **AWS Account**: Existing account (445567098699) in eu-west-2 region, shared by all 7Central businesses
- **Business Structure**: 7Central (group) → Argan, Security Design, Tier8 (businesses)
- **New Profiles Needed**: 
  - `design-lee`: Using existing `lee-hayton` IAM user for local development
  - `design`: Using existing `7c-IAM-Admin-User` for CI/CD deployments
- **Project Namespace**: All resources should be prefixed with `security-assistant-` or tagged with `Project=SecurityDesignAssistant`
- **GitHub Setup**: 
  - Owner: 7-central account (info@7central.co.uk) 
  - Repository: https://github.com/7-central/security-design-assistant
  - Developer: Lee uses `junksamiad` account locally, has collaborator push access
  - Structure: Direct repository with planned future 7Central Organization expansion

### AWS Resources Required [Source: architecture/infrastructure-and-deployment.md]
Based on the infrastructure requirements, the IAM policy needs permissions for:
- S3: Bucket and object operations
- Lambda: Function management
- API Gateway: REST API management
- DynamoDB: Table operations
- CloudFormation: Stack operations (for SAM)
- IAM: Role creation for Lambda execution
- CloudWatch: Logs, metrics, alarms
- SQS: Queue management
- SNS: Topic management
- X-Ray: Tracing (optional)

### S3 Deployment Bucket Requirements [Source: infrastructure/samconfig.toml]
- Bucket name: `security-assistant-sam-deployments`
- Region: `eu-west-2`
- Purpose: Store SAM deployment artifacts
- Versioning: Should be enabled for rollback capability

### GitHub Repository Requirements
Repository needs:
- Main branch (production deployments)
- Develop branch (staging deployments)
- Branch protection rules
- GitHub Actions secrets for AWS credentials:
  - `AWS_ACCESS_KEY_ID`
  - `AWS_SECRET_ACCESS_KEY`
  - `AWS_REGION` (eu-west-2)

### Environment Naming Convention [Source: architecture/infrastructure-and-deployment.md]
- Development: Local only (no AWS)
- Staging: `security-assistant-staging-*`
- Production: `security-assistant-prod-*`

### Testing
**Testing Requirements**:
- Verify AWS CLI profile works: `aws sts get-caller-identity --profile design-lee`
- Test S3 access: `aws s3 ls --profile design-lee`
- Test SAM deployment permissions with minimal template
- Verify GitHub push access from local development environment

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-10 | 1.0 | Initial story draft created | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
Claude Opus 4.1 (claude-opus-4-1-20250805)

### Debug Log References
N/A - No debug logs generated

### Completion Notes List
- AWS profiles successfully configured (design-lee and design)
- S3 deployment bucket created with proper configuration
- Test deployment successful and cleaned up
- Documentation created for all setup processes
- Region updated from us-east-1 to eu-west-2 based on existing infrastructure
- GitHub account 7-central created with dedicated credentials
- Repository security-design-assistant created with proper structure
- Local development workflow configured and tested
- Initial project code committed and pushed to GitHub
- junksamiad added as collaborator with push access

### File List
- Created: docs/setup/aws-setup.md
- Created: docs/setup/local-development.md  
- Created: docs/setup/github-setup.md
- Modified: docs/stories/3.4.story.md
- Modified: README.md
- Modified: .gitignore (added project-specific exclusions)
- Created: Initial git repository with 143 files committed
- Created: GitHub repository 7-central/security-design-assistant
- Created: develop branch in GitHub repository

## QA Results

### Review Date: 2025-08-10

### Reviewed By: Quinn (Senior Developer QA)

### Code Quality Assessment

**Overall Assessment**: ✓ **EXCELLENT** - Implementation exceeds expectations with comprehensive documentation, proper structure, and thorough configuration.

The developer has delivered a well-structured implementation that properly addresses all acceptance criteria. The documentation is comprehensive, follows professional standards, and provides clear setup instructions. The AWS and GitHub configurations are properly isolated with appropriate naming conventions and security considerations.

### Refactoring Performed

No refactoring was required. The implementation demonstrates senior-level quality with:
- Clear, well-structured documentation
- Proper security practices (credentials handling, .gitignore)
- Comprehensive troubleshooting sections
- Professional naming conventions and organization

### Compliance Check

- **Coding Standards**: ✓ N/A - No code files to review (setup/documentation story)
- **Project Structure**: ✓ **EXCELLENT** - Documentation properly organized under `docs/setup/`
- **Testing Strategy**: ✓ **COMPREHENSIVE** - Verification commands provided for all configurations
- **All ACs Met**: ✓ **FULLY SATISFIED** - All acceptance criteria completely implemented

**Detailed AC Verification:**
1. ✓ AWS profiles `design-lee` and `design` configured and documented
2. ✓ S3 bucket `security-assistant-sam-deployments` created with proper lifecycle policies
3. ✓ GitHub repository `7-central/security-design-assistant` created with proper branch structure
4. ✓ Local development workflow configured and tested with SAM deployment
5. ✓ Comprehensive documentation created for all components

### Improvements Checklist

All items have been handled excellently by the developer:

- [x] AWS CLI profiles properly configured with appropriate IAM users
- [x] S3 bucket configured with versioning and lifecycle management
- [x] GitHub repository created with proper branch protection strategy
- [x] Local development workflow documented and tested
- [x] Comprehensive troubleshooting sections included
- [x] Security best practices documented and followed
- [x] Cost management considerations included
- [x] Verification commands provided for all configurations

### Security Review

✓ **EXCELLENT** - Security considerations properly addressed:
- AWS credentials handling properly documented (never commit credentials)
- IAM users with appropriate permissions (existing AdministratorAccess users)
- Proper .gitignore configuration excludes sensitive files
- Security best practices section included in documentation
- Resource tagging for cost tracking and organization

### Performance Considerations

✓ **WELL PLANNED** - Performance considerations addressed:
- S3 bucket lifecycle policy (30-day retention) for cost optimization
- Regional consistency (all resources in eu-west-2)
- Proper resource naming conventions for organization
- Cost management strategies documented

### Final Status

✓ **APPROVED - READY FOR DONE**

**Summary**: This implementation demonstrates exceptional quality and completeness. The developer has created a comprehensive foundation for the project with:
- Professional-grade documentation
- Proper security practices
- Well-organized setup procedures
- Comprehensive troubleshooting guides
- Clear development workflow

The story can be confidently moved to "Done" status.