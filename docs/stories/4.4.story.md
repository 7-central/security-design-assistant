# Story 4.4: Essential Documentation

## Status
Draft

## Story
**As a** developer or operator,  
**I want** core documentation to understand and run the system,  
**so that** I can maintain and operate it effectively.

## Acceptance Criteria
1. README.md with:
   - Project overview (2-3 paragraphs)
   - Prerequisites and setup steps
   - Environment variables list
   - Quick start guide
   - Basic troubleshooting (top 5 issues)
2. API documentation:
   - Endpoint descriptions
   - Request/response examples
   - Error codes and meanings
   - Postman collection or similar
3. Deployment guide:
   - SAM deployment steps using security-assistant-sam-deployments bucket (AWS 445567098699, eu-west-2)
   - Environment configuration for staging/production
   - Rollback procedures for GitHub Actions workflows
4. Architecture overview:
   - Simple diagram (even hand-drawn)
   - Component descriptions
   - Data flow explanation
5. Prompt documentation:
   - Current prompt versions
   - What each agent does
   - How to modify prompts
6. Testing guide:
   - How to run tests
   - How to add new test drawings
   - How to interpret AI Judge results

## Tasks / Subtasks
- [ ] Task 1: Update README.md with comprehensive project information (AC: 1)
  - [ ] Write project overview section (2-3 paragraphs) explaining the system purpose
  - [ ] Document prerequisites: Python 3.11, AWS CLI, SAM CLI, poppler-utils
  - [ ] List all environment variables with descriptions and example values
  - [ ] Create quick start guide covering local setup and first run
  - [ ] Add troubleshooting section with top 5 common issues and solutions
- [ ] Task 2: Create API documentation (AC: 2)
  - [ ] Document all REST endpoints from rest-api-spec.md
  - [ ] Add request/response examples for each endpoint
  - [ ] Document error codes and their meanings
  - [ ] Create or export Postman collection for API testing
  - [ ] Save API documentation to docs/api/README.md
- [ ] Task 3: Write deployment guide (AC: 3)
  - [ ] Document SAM deployment process for staging/production
  - [ ] Include AWS account (445567098699) and region (eu-west-2) specifics
  - [ ] Explain environment configuration differences (dev/staging/prod)
  - [ ] Document GitHub Actions rollback procedures
  - [ ] Save to docs/deployment/README.md
- [ ] Task 4: Create architecture overview documentation (AC: 4)
  - [ ] Create simple architecture diagram showing component relationships
  - [ ] Write component descriptions for each major service
  - [ ] Document data flow from PDF upload to Excel generation
  - [ ] Save to docs/architecture/README.md (high-level summary)
- [ ] Task 5: Document AI prompts (AC: 5)
  - [ ] List current prompt versions from src/config/prompts/
  - [ ] Explain what each agent does (Context, Schedule, Excel, Judge)
  - [ ] Document how to modify prompts safely
  - [ ] Include prompt versioning strategy
  - [ ] Save to docs/prompts/README.md
- [ ] Task 6: Create testing guide (AC: 6)
  - [ ] Document test execution commands (pytest -m unit, pytest -m e2e)
  - [ ] Explain test organization and structure
  - [ ] Document how to add new test drawings to fixtures
  - [ ] Explain AI Judge evaluation interpretation
  - [ ] Save to docs/testing/README.md
- [ ] Task 7: Ensure all documentation is consistent and cross-referenced
  - [ ] Verify all file paths are correct
  - [ ] Check that examples work as documented
  - [ ] Ensure environment variables are consistent across docs
  - [ ] Add cross-references between related documentation

## Dev Notes

### Previous Story Insights
From Story 4.3.1 completion:
- GitHub Actions workflows successfully implemented in `.github/workflows/` [Source: Story 4.3.1 Completion Notes]
- Dev AWS resources deployed: S3 bucket `security-assistant-dev-445567098699` and DynamoDB table `security-assistant-dev-jobs` [Source: Story 4.3.1 Debug Log]
- Environment configuration templates created (`.env.local.example`, `.env.dev.example`, `.env.prod.example`) [Source: Story 4.3.1 Completion Notes]
- CORS security vulnerability fixed with environment-aware configuration [Source: Story 4.3.1 QA Results]
- E2E tests refactored to use FastAPI server instead of Lambda/SQS [Source: Story 4.3.1 Completion Notes]

### Project Structure
Based on current source tree [Source: architecture/source-tree.md]:
- Documentation location: `docs/` directory
- Existing subdirectories: `docs/api/`, `docs/deployment/`, `docs/architecture/`, `docs/prd/`, `docs/stories/`
- Configuration files: `.env.example` exists, environment templates in root
- Test fixtures: `tests/fixtures/` with PDFs and test data

### Tech Stack Information
[Source: architecture/tech-stack.md]:
- **Language**: Python 3.11 (strict version requirement)
- **API Framework**: FastAPI 0.109.0
- **AI Provider**: Google GenAI SDK 0.2.0 (migrated from Vertex AI)
- **Models**: Gemini 2.5 Flash (context/Excel), Gemini 2.5 Pro (drawing analysis)
- **Testing**: pytest 8.0.0
- **Infrastructure**: AWS SAM 1.100+
- **CI/CD**: GitHub Actions

### API Specifications
[Source: architecture/rest-api-spec.md]:
- **Endpoints**:
  - `GET /health` - Health check
  - `POST /process-drawing` - Submit drawing for processing
  - `GET /status/{job_id}` - Check job status
  - `GET /download/{job_id}/{file_type}` - Download results
- **Server URLs**:
  - Production: `https://api.security-assistant.7central.com`
  - Local: `http://localhost:8000`

### Deployment Information
[Source: architecture/infrastructure-and-deployment.md]:
- **AWS Account**: 445567098699
- **Region**: eu-west-2
- **SAM Artifacts Bucket**: security-assistant-sam-deployments
- **Environments**:
  - Local + Dev AWS: <$1/month (dev resources only)
  - Staging: ~$5/month (full infrastructure)
  - Production: Full deployment
- **GitHub Actions Workflows** [Source: Story 4.3.1]:
  - `.github/workflows/ci.yml` - CI testing
  - `.github/workflows/deploy-dev.yml` - Dev deployment
  - `.github/workflows/deploy-prod.yml` - Production deployment

### Component Information
[Source: architecture/components.md]:
- **Context Agent**: Processes optional context documents (DOCX/PDF/TXT)
- **Schedule Agent**: Analyzes drawings and extracts components
- **Excel Generation Agent**: Creates Excel using Gemini code execution
- **Judge Agent**: Evaluates extraction quality
- **Storage Abstraction**: Unified interface for local/AWS storage

### Prompt Locations
[Source: architecture/source-tree.md]:
- Context prompt: `src/config/prompts/context_prompt.txt`
- Schedule prompt: `src/config/prompts/schedule_prompt.txt`
- Judge prompt: `src/config/prompts/judge_prompt.txt`

### Testing Information
[Source: architecture/test-strategy-and-standards.md]:
- **Test Distribution**: 90% unit tests, 10% E2E tests
- **Unit Tests**: Run with `pytest -m unit`, <10 seconds total
- **E2E Tests**: Run with `ENV=dev pytest -m e2e`, <2 minutes per test
- **Dev Resources Required**: Must deploy dev AWS resources first
- **Test Fixtures**: Located in `tests/fixtures/pdfs/`

## Testing

### Testing Standards
[Source: architecture/test-strategy-and-standards.md]:
- **Test Location**: Documentation should reference test locations in `tests/` directory
- **Framework**: pytest 8.0.0 for all testing
- **E2E Test Requirement**: Must have dev AWS resources deployed
- **Performance Targets**: Unit tests <10s, E2E tests <2min
- **Coverage**: Focus on critical paths, not metrics

## Dev Agent Record

### Agent Model Used
[To be populated by dev agent]

### Debug Log References
[To be populated by dev agent]

### Completion Notes
[To be populated by dev agent]

### File List
[To be populated by dev agent]

## QA Results
[To be populated by QA agent]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-12 | 1.0 | Initial story creation from Epic 4 | Bob (Scrum Master) |